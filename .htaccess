Options -MultiViews
RewriteEngine On

# 1) Redirect direct requests for .html to extensionless URLs (canonicalization only)
RewriteCond %{THE_REQUEST} \s/([^.]+)\.html[\s?] [NC]
RewriteRule ^ %1 [R=301,L]

# 1b) Redirect single-segment URLs with trailing slash to non-slash form
#     when a same-named .html exists (fixes broken relative asset paths)
RewriteCond %{REQUEST_URI} ^/([A-Za-z0-9_-]+)/$ [NC]
RewriteCond %{DOCUMENT_ROOT}/%1.html -f
RewriteRule ^ %1 [R=301,L]

# 2) Serve real files as-is (assets, images, etc.)
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# 3) Internally rewrite single-segment URLs (with or without trailing slash)
#    to their .html counterparts if such file exists. This avoids 403 and
#    prevents slash/no-slash redirect loops when a same-named directory exists.
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^([A-Za-z0-9_-]+)/?$ $1.html [L]


